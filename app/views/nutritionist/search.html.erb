<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>The Nutrium Challange</title>
  <meta name="description" content="The HTML5 page of search nutricionist">
  <meta name="author" content="nelsontss">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <%= javascript_include_tag "nutritionist" %>


</head>
<body>
  <header class="header">
    <nav class="nav-extended">
      <div class="nav-wrapper container">
        <a href=""><%= image_tag("nutrium-logo.png", :alt => "nutrium logo", style: 'height:50px;width:auto;filter: brightness(0) invert(1);') %></a>
        <ul class="right hide-on-med-and-down">
          <li><a href="">
                <i class="material-icons right">arrow_right_alt</i>
                Are you a healthcare professional?<strong style="padding-left: 4px">Sign Up Here</strong>
          </a></li>
        </ul>
      </div>
      <div class="nav-wrapper container">
        <form action="/nutritionist/search" method="get" accept-charset="UTF-8">
            <div class="row search-row valign-wrapper">
              <div class="input-field row-element col s4">
                <input id="nt_type" name="nt_type" value="Nutricionista Desportivo" id="searchArea" type="search" required>
                <label class="label-icon" for="search"><i class="material-icons">search</i></label>
              </div>
              <div class="input-field row-element col s4">

                <input id="city" name="city" value="Braga" id="searchCity" type="search" required>
                <label class="label-icon" for="search"><i class="material-icons">search</i></label>
                <i class="material-icons">my_location</i>
              </div>
              <div class="row-element col s4">
                <input type="submit" value="Pesquisar" class="btn" style="height: 72px"/>
              </div>
            </div>
        </form>
      </div>
    </nav>
  </header>
  <main class="container">
    <% @nutritionists.each do |nutritionist| %>
    <div class="row">
      <div class="card-list">
        <div class="card horizontal">
          <div class="card-content">
            <div class="row">
              <div class="card-image col s2">
                <%= image_tag(nutritionist.image, :alt => "person logo", style: 'height:100px;width:100px;') %>
              </div>
              <div class="col s4">
                <div class="row row-name">
                  <p class="name"><%= nutritionist.name %></p>
                </div>
                <div class="row sub-information">
                  <div class="col sub-information-col">
                    <p><%= nutritionist.nutritionist_type %></p>
                  </div>
                  <div class="col sub-information-col">
                    <p><%= nutritionist.code %></p>
                  </div>
                </div>
              </div>
              <div class="right col s4">
                <a class="btn mc-consulta">Marcar Consulta</a>
                <a class="btn pg-pessoa">Pagina Pessoal</a>
              </div>
            </div>

            <div class="row ">
              <div class="col s4 offset-s2">
                <div class="row card-clinic-row valign-wrapper">
                  <div class="col s1 info-icon">
                    <i class="material-icons">place</i>
                  </div>
                  <div class="col s11">
                    <p class="clinic-name"><%= nutritionist.clinic.name %></p>
                  </div>
                </div>
                <div class="row card-clinic-row">
                  <div class="col s11 offset-s1">
                    <p><%= nutritionist.clinic.street %></p>
                  </div>
                </div>
                <div class="row card-clinic-row">
                  <div class="col s11 offset-s1">
                    <p><%= nutritionist.clinic.place %>, <%= nutritionist.clinic.city %></p>
                  </div>
                </div>
              </div>
              <div class="col s4">
                <div class="row card-clinic-row valign-wrapper" style="height: 70%">
                  <div class="col s1 info-icon">
                    <i class="material-icons">business_center</i>
                  </div>
                  <div class="input-field col s11 my-select" style="margin-left: 2%">
                    <select id="appointment_types_<%= nutritionist.id %>">
                      <script>prices[<%= nutritionist.id %>] = []</script>
                      <% nutritionist.appointment.each do |appointment| %>
                        <script>prices[<%= nutritionist.id %>].push(<%= appointment.price %>)</script>
                        <option class="my-option" value="<%= appointment.id %>"><%= appointment.appointment_type %></option>
                      <% end %>
                    </select>
                  </div>
                </div>
                <div class="row card-clinic-row valign-wrapper">
                  <div class="col s1 info-icon">
                    <i class="material-icons">payments</i>
                  </div>
                  <div class="col s11" style="margin-left: 2%">
                    <p id="appointment_price_<%= nutritionist.id %>"> <%= nutritionist.appointment.first().price %> €</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <%end%>
  </main>
  <div class="white" style="padding-top: 2%;: 2%;padding-bottom: 2%; margin-bottom: 0">
    <ul class="container pagination">
      <li class="waves-effect "><a href="#!">1</a></li>
      <li class="waves-effect"><a href="#!">2</a></li>
      <li class="waves-effect"><a href="#!">3</a></li>
      <li class="waves-effect"><a href="#!">4</a></li>
      <li class="active selected-pg"><a href="#!">5</a></li>
      <li class="waves-effect"><a href="#!">6</a></li>
      <li class="waves-effect"><a href="#!">7</a></li>
      <li class="waves-effect"><a href="#!">8</a></li>
      <li class="waves-effect"><a href="#!">9</a></li>
      <li class="waves-effect"><a href="#!">10</a></li>
      <li class="waves-effect"><a href="#!"><i class="material-icons">chevron_right</i></a></li>
    </ul>
  </div>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script>
    $('select').formSelect();
    <% @nutritionists.each do |nutritionist| %>
      $("#appointment_types_<%= nutritionist.id %>").on('change', function(change) {
          const index = document.querySelector("#appointment_types_<%= nutritionist.id %>").selectedIndex;
          document.querySelector("#appointment_price_<%= nutritionist.id %>").innerText = prices[<%= nutritionist.id %>][index] + " €";
      });
    <% end %>
</script>
</html>